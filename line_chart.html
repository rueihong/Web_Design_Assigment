<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Malaysia COVID-19 Monthly Dataset — Line_Chart</title>
  <link rel="stylesheet" href="line_chart.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
</head>
<body class="body1">
    
  <div class="sidebar">
    <a href="index.html">Home</a>
    <a href="covid.html">About Covid</a>
    <a href="line_chart.html">Line Chart</a>
    <a href="pie_chart.html">Pie Chart</a>
    <a href="bar_chart.html">Bar Chart</a>
    <a href="https://data.moh.gov.my/data-catalogue/covid_cases"><img src="KKMNOW.webp" width="150px" height=75px"></a>
  </div>
	
  <div class="contain">	
    <div class="container">
    <header>
      <h1>Malaysia COVID-19 Monthly Dataset — Line_graph</h1>
    </header>
	
    <section class="card">
      <p class="small">This line chart shows the number of case_active in Kedah,Johor,Melaka on the last day of each month from 2020 to 2021.
      Case_active is calculated as the total cases minus the number of recovered cases, representing the number 
      of people who have contracted COVID-19 but have not yet recovered.</p>
      <label for="state"><strong>Filter by State:</strong></label>
	  <select id="state" onchange="showChart()">
	    <option value="kedah">Kedah</option>
		<option value="johor">Johor</option>
		<option value="melaka">Melaka</option>
	  </select>
    
	  <div id="chartsContainer">
        <canvas id="chart_kedah" width="100%"></canvas>
        <canvas id="chart_johor" width="100%" style="display:none"></canvas>
        <canvas id="chart_melaka" width="100%" style="display:none"></canvas>
      </div>
	</section>

      <section class="card">
        <h3>Data Set:</h3>
        <p><a href="https://data.moh.gov.my/data-catalogue/covid_cases/" target="_blank">https://data.moh.gov.my/data-catalogue/covid_cases/</a></p>
      </section>
	  <section class="card">
	    <h3>Malaysia COVID-19 Monthly Cases_active table</h3>
		<label for="choiceState"><strong>Filter by State:</strong></label>
	      <select id="choiceState" onchange="loadData()">
	        <option value="kedah">Kedah</option>
		    <option value="johor">Johor</option>
		    <option value="melaka">Melaka</option>
	      </select>
		<table id="dataTable">
          <caption>Click a header to sort</caption>
          <thead>
            <tr>
              <th data-type="number">Year <span class="arrow"></span></th>
              <th data-type="month">Month <span class="arrow"></span></th>
              <th data-type="string">State <span class="arrow"></span></th>
              <th data-type="number">Cases_active <span class="arrow"></span></th>
            </tr>
          </thead>
          <tbody></tbody>
      </table>  
	  </section>
	  </div>

<script>
function showChart() {
    const selected = document.getElementById("state").value;
    document.querySelectorAll("#chartsContainer canvas").forEach(canvas => {
        canvas.style.display = "none"; 
    });
    document.getElementById("chart_" + selected).style.display = "block"; 
}

const labels = [
  '2020/1','2020/2','2020/3','2020/4','2020/5','2020/6','2020/7','2020/8',
  '2020/9','2020/10','2020/11','2020/12',
  '2021/1','2021/2','2021/3','2021/4','2021/5','2021/6','2021/7','2021/8',
  '2021/9','2021/10','2021/11','2021/12'
];

const kedahData = [1,0,54,10,4,3,11,53,64,277,242,139,1782,461,343,700,4022,1970,11487,18874,6688,3612,3393,1716];

const johorData = [7,0,295,281,37,7,40,0,15,76,325,2875,8017,4482,1559,2203,6502,4471,12018,24640,23496,7343,7099,5130];

const melakaData = [0,0,50,79,14,5,0,3,4,16,9,549,1222,275,320,345,3094,2820,5792,6871,4179,3076,2196,1305];

function createChart(canvasId, label, data, color) {
  return new Chart(document.getElementById(canvasId), {
    type: "line",
    data: {
      labels: labels,
      datasets: [{
        label: label,
        data: data,
        fill: false,
        borderColor: color,
        backgroundColor: "rgba(0, 123, 255, 0.1)",
        borderWidth: 2,
        tension: 0.3,
        pointBackgroundColor: color,
        pointRadius: 4,
        pointHoverRadius: 6
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          display: true,
          labels: { color: "#333", font: { size: 14 } }
        },
        tooltip: {
          backgroundColor: "rgba(0,0,0,0.7)",
          titleFont: { size: 14 },
          bodyFont: { size: 13 },
          padding: 10
        }
      },
      scales: {
        x: { grid: { color: "rgba(0,0,0,0.05)" }, ticks: { color: "#333" } },
        y: {
          min: 0,
          max: 300000,
          grid: { color: "rgba(0,0,0,0.05)" },
          ticks: { color: "#333" }
        }
      }
    }
  });
}

createChart("chart_kedah", "Kedah Cases", kedahData, "red");
createChart("chart_johor", "Johor Cases", johorData, "blue");
createChart("chart_melaka", "Melaka Cases", melakaData, "green");

const stateData = {
    kedah: [              
        { year: 2020, month: "Jan", state: "Kedah", cases: 1 },
        { year: 2020, month: "Feb", state: "Kedah", cases: 2 },
        { year: 2020, month: "Mar", state: "Kedah", cases: 54 },
		{ year: 2020, month: "Apr", state: "Kedah", cases: 10 },
        { year: 2020, month: "May", state: "Kedah", cases: 4 },
        { year: 2020, month: "Jun", state: "Kedah", cases: 3 },
		{ year: 2020, month: "Jul", state: "Kedah", cases: 11 },
        { year: 2020, month: "Aug", state: "Kedah", cases: 53 },
        { year: 2020, month: "Sep", state: "Kedah", cases: 64 },
		{ year: 2020, month: "Oct", state: "Kedah", cases: 277 },
        { year: 2020, month: "Nov", state: "Kedah", cases: 242 },
        { year: 2020, month: "Dec", state: "Kedah", cases: 139 },
		{ year: 2021, month: "Jan", state: "Kedah", cases: 1782 },
        { year: 2021, month: "Feb", state: "Kedah", cases: 461 },
        { year: 2021, month: "Mar", state: "Kedah", cases: 343 },
		{ year: 2021, month: "Apr", state: "Kedah", cases: 700 },
        { year: 2021, month: "May", state: "Kedah", cases: 4022 },
        { year: 2021, month: "Jun", state: "Kedah", cases: 1970 },
		{ year: 2021, month: "Jul", state: "Kedah", cases: 11487 },
        { year: 2021, month: "Aug", state: "Kedah", cases: 18874 },
        { year: 2021, month: "Sep", state: "Kedah", cases: 6688 },
		{ year: 2021, month: "Oct", state: "Kedah", cases: 3612 },
        { year: 2021, month: "Nov", state: "Kedah", cases: 3393 },
        { year: 2021, month: "Dec", state: "Kedah", cases: 1716 }
    ],
    johor: [
        { year: 2020, month: "Jan", state: "Johor", cases: 7 },
        { year: 2020, month: "Feb", state: "Johor", cases: 0 },
        { year: 2020, month: "Mar", state: "Johor", cases: 295 },
		{ year: 2020, month: "Apr", state: "Johor", cases: 281 },
        { year: 2020, month: "May", state: "Johor", cases: 37 },
        { year: 2020, month: "Jun", state: "Johor", cases: 7 },
		{ year: 2020, month: "Jul", state: "Johor", cases: 40 },
        { year: 2020, month: "Aug", state: "Johor", cases: 0 },
        { year: 2020, month: "Sep", state: "Johor", cases: 15 },
		{ year: 2020, month: "Oct", state: "Johor", cases: 76 },
        { year: 2020, month: "Nov", state: "Johor", cases: 325 },
        { year: 2020, month: "Dec", state: "Johor", cases: 2875 },
		{ year: 2021, month: "Jan", state: "Johor", cases: 8017 },
        { year: 2021, month: "Feb", state: "Johor", cases: 4482 },
        { year: 2021, month: "Mar", state: "Johor", cases: 1559 },
		{ year: 2021, month: "Apr", state: "Johor", cases: 2203 },
        { year: 2021, month: "May", state: "Johor", cases: 6502 },
        { year: 2021, month: "Jun", state: "Johor", cases: 4471 },
		{ year: 2021, month: "Jul", state: "Johor", cases: 12018 },
        { year: 2021, month: "Aug", state: "Johor", cases: 24640 },
        { year: 2021, month: "Sep", state: "Johor", cases: 23496 },
		{ year: 2021, month: "Oct", state: "Johor", cases: 7343 },
        { year: 2021, month: "Nov", state: "Johor", cases: 7099 },
        { year: 2021, month: "Dec", state: "Johor", cases: 5130 }
    ],
    melaka: [
        { year: 2020, month: "Jan", state: "Melaka", cases: 0 },
        { year: 2020, month: "Feb", state: "Melaka", cases: 0 },
        { year: 2020, month: "Mar", state: "Melaka", cases: 50 },
		{ year: 2020, month: "Apr", state: "Melaka", cases: 79 },
        { year: 2020, month: "May", state: "Melaka", cases: 14 },
        { year: 2020, month: "Jun", state: "Melaka", cases: 5 },
		{ year: 2020, month: "Jul", state: "Melaka", cases: 0 },
        { year: 2020, month: "Aug", state: "Melaka", cases: 3 },
        { year: 2020, month: "Sep", state: "Melaka", cases: 4 },
		{ year: 2020, month: "Oct", state: "Melaka", cases: 16 },
        { year: 2020, month: "Nov", state: "Melaka", cases: 9 },
        { year: 2020, month: "Dec", state: "Melaka", cases: 549 },
		{ year: 2021, month: "Jan", state: "Melaka", cases: 1222 },
        { year: 2021, month: "Feb", state: "Melaka", cases: 275 },
        { year: 2021, month: "Mar", state: "Melaka", cases: 320 },
		{ year: 2021, month: "Apr", state: "Melaka", cases: 345 },
        { year: 2021, month: "May", state: "Melaka", cases: 3094 },
        { year: 2021, month: "Jun", state: "Melaka", cases: 2820 },
		{ year: 2021, month: "Jul", state: "Melaka", cases: 5792 },
        { year: 2021, month: "Aug", state: "Melaka", cases: 6871 },
        { year: 2021, month: "Sep", state: "Melaka", cases: 4179 },
		{ year: 2021, month: "Oct", state: "Melaka", cases: 3076 },
        { year: 2021, month: "Nov", state: "Melaka", cases: 2196 },
        { year: 2021, month: "Dec", state: "Melaka", cases: 1305 }
    ]
};

function loadData() {
    const choice = document.getElementById("choiceState").value;
    const tbody = document.querySelector("#dataTable tbody");
    tbody.innerHTML = ""; 

    stateData[choice].forEach(row => {
        const tr = document.createElement("tr");
        tr.innerHTML = `<td>${row.year}</td><td>${row.month}</td><td>${row.state}</td><td>${row.cases}</td>`;
        tbody.appendChild(tr);
    });
}


loadData();
(function () {
  const monthOrder = {jan:1,feb:2,mar:3,apr:4,may:5,jun:6,jul:7,aug:8,sep:9,oct:10,nov:11,dec:12};
  const table = document.getElementById('dataTable');
  const tbody = table.tBodies[0];
  const headers = Array.from(table.tHead.querySelectorAll('th'));
  let currentSort = { col: -1, dir: 'asc' };

  headers.forEach((th, index) => {
    th.addEventListener('click', () => sortByColumn(index, th));
  });

  function sortByColumn(colIndex, header) {
    const type = header.dataset.type || 'string';
    if (currentSort.col === colIndex) {
      currentSort.dir = currentSort.dir === 'asc' ? 'desc' : 'asc';
    } else {
      currentSort.col = colIndex;
      currentSort.dir = 'asc';
    }
    headers.forEach(h => h.removeAttribute('data-sort'));
    header.setAttribute('data-sort', currentSort.dir);
    const rows = Array.from(tbody.rows);
    const multiplier = currentSort.dir === 'asc' ? 1 : -1;
    rows.sort((r1, r2) => {
      const a = cellValue(r1.cells[colIndex], type);
      const b = cellValue(r2.cells[colIndex], type);
      return (a > b ? 1 : a < b ? -1 : 0) * multiplier;
    });
    rows.forEach(r => tbody.appendChild(r));
  }

  function cellValue(cell, type) {
    let txt = cell.textContent.trim();
    if (type === 'number') return parseFloat(txt.replace(/,/g,'')) || 0;
    if (type === 'month') return monthOrder[txt.toLowerCase().slice(0,3)] || 0;
    return txt.toLowerCase();
  }

  // Filtering by select
  const select = document.getElementById('choiceState');
  select.addEventListener('change', () => {
    const val = select.value.toLowerCase();
    Array.from(tbody.rows).forEach(row => {
      const country = row.cells[2].textContent.trim().toLowerCase();
      row.style.display = (val === 'all' || country === val) ? '' : 'none';
    });
  });
})();
</script>
</body>
</html>
